[["data.html", "5 データの読み込み 5.1 様々な形式のデータの読み込み 5.2 データの確認 5.3 データの加工と集計", " 5 データの読み込み 5.1 様々な形式のデータの読み込み 5.1.1 csvデータの読み込み read_csv()を用いる．read.csvでも可能． library(tidyverse) ## ─ Attaching packages ──────────────────── tidyverse 1.3.1 ─ ## ✓ tibble 3.1.4 ✓ dplyr 1.0.7 ## ✓ tidyr 1.1.3 ✓ stringr 1.4.0 ## ✓ readr 2.0.1 ✓ forcats 0.5.1 ## ✓ purrr 0.3.4 ## ─ Conflicts ───────────────────── tidyverse_conflicts() ─ ## x dplyr::filter() masks stats::filter() ## x dplyr::lag() masks stats::lag() d_csv &lt;- read_csv(&quot;data/example_1.csv&quot;) ## Rows: 1854 Columns: 9 ## ─ Column specification ──────────────────────────── ## Delimiter: &quot;,&quot; ## dbl (9): id, c1_1, c2a, c2b, c2c, c2d, c2e, c17_1hensa, c15a ## ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. d_csv ## # A tibble: 1,854 × 9 ## id c1_1 c2a c2b c2c c2d c2e c17_1hensa c15a ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 2 2 3 3 3 2 68 1 ## 2 2 2 1 4 3 5 3 43 2 ## 3 3 2 2 4 2 5 4 56 3 ## 4 4 1 3 4 1 5 5 39 4 ## 5 5 2 1 5 4 5 2 59 1 ## 6 6 2 1 2 3 5 2 58 2 ## 7 7 1 2 3 3 5 4 41 4 ## 8 8 2 2 2 2 3 3 46 3 ## 9 9 1 1 4 4 5 3 35.5 3 ## 10 10 2 2 3 3 5 2 46 2 ## # … with 1,844 more rows 5.1.2 xlsxデータの読み込み xlsxデータを読み込む． library(readxl) d_excel &lt;- read_excel(&quot;data/example_1.xlsx&quot;) d_excel ## # A tibble: 1,854 × 9 ## id c1_1 c2a c2b c2c c2d c2e c17_1hensa c15a ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 2 2 3 3 3 2 68 1 ## 2 2 2 1 4 3 5 3 43 2 ## 3 3 2 2 4 2 5 4 56 3 ## 4 4 1 3 4 1 5 5 39 4 ## 5 5 2 1 5 4 5 2 59 1 ## 6 6 2 1 2 3 5 2 58 2 ## 7 7 1 2 3 3 5 4 41 4 ## 8 8 2 2 2 2 3 3 46 3 ## 9 9 1 1 4 4 5 3 35.5 3 ## 10 10 2 2 3 3 5 2 46 2 ## # … with 1,844 more rows 5.1.3 dtaデータの読み込み Stataで用いられているdtaデータを読み込むにはhavenパッケージのread_dtaを用いる． SPSSの場合はread_sav，SASの場合はread_sasを使えばよい． library(haven) d_dta &lt;- read_dta(&quot;data/example_1.dta&quot;) d_dta ## # A tibble: 1,854 × 9 ## id c1_1 c2a c2b c2c c2d c2e c17_1hensa c15a ## &lt;dbl&gt; &lt;dbl+lbl&gt; &lt;dbl+lb&gt; &lt;dbl+lb&gt; &lt;dbl+lb&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+lbl&gt; &lt;dbl+l&gt; ## 1 1 2 [女性] 2 [まああて… 3 [どちらと… 3 [どちらと… 3 [どちら… 2 [まああ… 68 1 [上のほ… ## 2 2 2 [女性] 1 [あてはま… 4 [あまりあ… 3 [どちらと… 5 [あては… 3 [どちら… 43 2 [真ん中… ## 3 3 2 [女性] 2 [まああて… 4 [あまりあ… 2 [まああて… 5 [あては… 4 [あまり… 56 3 [真ん中… ## 4 4 1 [男性] 3 [どちらと… 4 [あまりあ… 1 [あてはま… 5 [あては… 5 [あては… 39 4 [真ん中… ## 5 5 2 [女性] 1 [あてはま… 5 [あてはま… 4 [あまりあ… 5 [あては… 2 [まああ… 59 1 [上のほ… ## 6 6 2 [女性] 1 [あてはま… 2 [まああて… 3 [どちらと… 5 [あては… 2 [まああ… 58 2 [真ん中… ## 7 7 1 [男性] 2 [まああて… 3 [どちらと… 3 [どちらと… 5 [あては… 4 [あまり… 41 4 [真ん中… ## 8 8 2 [女性] 2 [まああて… 2 [まああて… 2 [まああて… 3 [どちら… 3 [どちら… 46 3 [真ん中… ## 9 9 1 [男性] 1 [あてはま… 4 [あまりあ… 4 [あまりあ… 5 [あては… 3 [どちら… 35.5 3 [真ん中… ## 10 10 2 [女性] 2 [まああて… 3 [どちらと… 3 [どちらと… 5 [あては… 2 [まああ… 46 2 [真ん中… ## # … with 1,844 more rows 5.1.4 変数ラベルと値ラベルの削除 もともとのデータセットに変数ラベルや値ラベルがある場合があるが，それらを除きたければzap_labelとzap_labelsを用いる．個人的にはラベルは無いほうがよいと考えている（基本はコードブックなどで確認すべきこと）ので，削除する． d_dta &lt;- d_dta %&gt;% zap_label() d_dta &lt;- d_dta %&gt;% zap_labels() d_dta ## # A tibble: 1,854 × 9 ## id c1_1 c2a c2b c2c c2d c2e c17_1hensa c15a ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 2 2 3 3 3 2 68 1 ## 2 2 2 1 4 3 5 3 43 2 ## 3 3 2 2 4 2 5 4 56 3 ## 4 4 1 3 4 1 5 5 39 4 ## 5 5 2 1 5 4 5 2 59 1 ## 6 6 2 1 2 3 5 2 58 2 ## 7 7 1 2 3 3 5 4 41 4 ## 8 8 2 2 2 2 3 3 46 3 ## 9 9 1 1 4 4 5 3 35.5 3 ## 10 10 2 2 3 3 5 2 46 2 ## # … with 1,844 more rows 5.2 データの確認 d &lt;- read_csv(&quot;data/example_1.csv&quot;) ## Rows: 1854 Columns: 9 ## ─ Column specification ──────────────────────────── ## Delimiter: &quot;,&quot; ## dbl (9): id, c1_1, c2a, c2b, c2c, c2d, c2e, c17_1hensa, c15a ## ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. d ## # A tibble: 1,854 × 9 ## id c1_1 c2a c2b c2c c2d c2e c17_1hensa c15a ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 2 2 3 3 3 2 68 1 ## 2 2 2 1 4 3 5 3 43 2 ## 3 3 2 2 4 2 5 4 56 3 ## 4 4 1 3 4 1 5 5 39 4 ## 5 5 2 1 5 4 5 2 59 1 ## 6 6 2 1 2 3 5 2 58 2 ## 7 7 1 2 3 3 5 4 41 4 ## 8 8 2 2 2 2 3 3 46 3 ## 9 9 1 1 4 4 5 3 35.5 3 ## 10 10 2 2 3 3 5 2 46 2 ## # … with 1,844 more rows ケースと変数の数を確認 dim(d) ## [1] 1854 9 変数名の確認 names(d) ## [1] &quot;id&quot; &quot;c1_1&quot; &quot;c2a&quot; &quot;c2b&quot; &quot;c2c&quot; ## [6] &quot;c2d&quot; &quot;c2e&quot; &quot;c17_1hensa&quot; &quot;c15a&quot; summary(d) ## id c1_1 c2a c2b ## Min. : 1.0 Min. :1.000 Min. :1.000 Min. :1.00 ## 1st Qu.: 464.2 1st Qu.:1.000 1st Qu.:1.000 1st Qu.:3.00 ## Median : 927.5 Median :2.000 Median :2.000 Median :4.00 ## Mean : 927.5 Mean :1.508 Mean :1.768 Mean :3.48 ## 3rd Qu.:1390.8 3rd Qu.:2.000 3rd Qu.:2.000 3rd Qu.:4.00 ## Max. :1854.0 Max. :2.000 Max. :5.000 Max. :5.00 ## NA&#39;s :5 NA&#39;s :8 ## c2c c2d c2e c17_1hensa ## Min. :1.000 Min. :1.000 Min. :1.000 Min. :30.00 ## 1st Qu.:2.000 1st Qu.:3.000 1st Qu.:2.000 1st Qu.:44.75 ## Median :3.000 Median :4.000 Median :2.000 Median :52.00 ## Mean :2.727 Mean :4.061 Mean :2.423 Mean :52.19 ## 3rd Qu.:3.000 3rd Qu.:5.000 3rd Qu.:3.000 3rd Qu.:60.00 ## Max. :5.000 Max. :5.000 Max. :5.000 Max. :75.00 ## NA&#39;s :12 NA&#39;s :11 NA&#39;s :6 NA&#39;s :251 ## c15a ## Min. :1.000 ## 1st Qu.:2.000 ## Median :3.000 ## Mean :2.622 ## 3rd Qu.:3.000 ## Max. :5.000 ## NA&#39;s :26 library(skimr) skim(d) Table 5.1: Data summary Name d Number of rows 1854 Number of columns 9 _______________________ Column type frequency: numeric 9 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist id 0 1.00 927.50 535.35 1 464.25 927.5 1390.75 1854 ▇▇▇▇▇ c1_1 0 1.00 1.51 0.50 1 1.00 2.0 2.00 2 ▇▁▁▁▇ c2a 5 1.00 1.77 0.95 1 1.00 2.0 2.00 5 ▇▆▂▁▁ c2b 8 1.00 3.48 1.20 1 3.00 4.0 4.00 5 ▂▃▆▇▆ c2c 12 0.99 2.73 1.08 1 2.00 3.0 3.00 5 ▃▅▇▃▁ c2d 11 0.99 4.06 1.14 1 3.00 4.0 5.00 5 ▁▁▃▃▇ c2e 6 1.00 2.42 1.09 1 2.00 2.0 3.00 5 ▅▇▆▂▁ c17_1hensa 251 0.86 52.19 9.72 30 44.75 52.0 60.00 75 ▃▇▇▇▂ c15a 26 0.99 2.62 1.23 1 2.00 3.0 3.00 5 ▆▇▇▃▂ table(d$c1_1) ## ## 1 2 ## 912 942 library(janitor) ## ## 次のパッケージを付け加えます: &#39;janitor&#39; ## 以下のオブジェクトは &#39;package:stats&#39; からマスクされています: ## ## chisq.test, fisher.test tabyl(d_dta, c1_1) ## c1_1 n percent ## 1 912 0.4919094 ## 2 942 0.5080906 5.3 データの加工と集計 データの加工と集計で主に使用するのは次の関数である． 関数 &lt;- c(&quot;select&quot;, &quot;filter&quot;, &quot;drop_na&quot;, &quot;mutate&quot;, &quot;summarise&quot;, &quot;group_by&quot;,&quot;ungroup&quot;) 目的 &lt;- c(&quot;変数を選択&quot;, &quot;ケースを選択&quot;, &quot;欠損値の削除&quot;, &quot;変数の追加&quot;, &quot;データの要約&quot;,&quot;グループ別の処理&quot;,&quot;グループ化の解除&quot;) 例 &lt;- c(&quot;`d %&gt;% select(var1, var2)`&quot;, &quot;`d %&gt;% filter(var1 &gt;= 5)`&quot;, &quot;`d %&gt;% drop_na(var1, var2)`&quot;, &quot;`d &lt;- d %&gt;% mutate(var3 = var1 + var2)`&quot;, &quot;`d %&gt;% summarise(Mean = mean(var1))`&quot;, &quot;`d %&gt;% group_by(group) %&gt;% summarise(Median = median(var1))`&quot;, &quot;`d %&gt;% group_by(group) %&gt;% summarise(Median = median(var1)) %&gt;% ungroup()`&quot;) tibble(関数,目的,例) %&gt;% knitr::kable() 関数 目的 例 select 変数を選択 d %&gt;% select(var1, var2) filter ケースを選択 d %&gt;% filter(var1 &gt;= 5) drop_na 欠損値の削除 d %&gt;% drop_na(var1, var2) mutate 変数の追加 d &lt;- d %&gt;% mutate(var3 = var1 + var2) summarise データの要約 d %&gt;% summarise(Mean = mean(var1)) group_by グループ別の処理 d %&gt;% group_by(group) %&gt;% summarise(Median = median(var1)) ungroup グループ化の解除 d %&gt;% group_by(group) %&gt;% summarise(Median = median(var1)) %&gt;% ungroup() 5.3.1 変数を選択する d %&gt;% select(id, c1_1) ## # A tibble: 1,854 × 2 ## id c1_1 ## &lt;dbl&gt; &lt;dbl&gt; ## 1 1 2 ## 2 2 2 ## 3 3 2 ## 4 4 1 ## 5 5 2 ## 6 6 2 ## 7 7 1 ## 8 8 2 ## 9 9 1 ## 10 10 2 ## # … with 1,844 more rows c2を含む変数を選択する場合にはcontainsを用いる． d %&gt;% select(id, contains(&quot;c2&quot;)) ## # A tibble: 1,854 × 6 ## id c2a c2b c2c c2d c2e ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 2 3 3 3 2 ## 2 2 1 4 3 5 3 ## 3 3 2 4 2 5 4 ## 4 4 3 4 1 5 5 ## 5 5 1 5 4 5 2 ## 6 6 1 2 3 5 2 ## 7 7 2 3 3 5 4 ## 8 8 2 2 2 3 3 ## 9 9 1 4 4 5 3 ## 10 10 2 3 3 5 2 ## # … with 1,844 more rows 関数 &lt;- c(&quot;starts_with&quot;, &quot;ends_with&quot;, &quot;contains&quot;, &quot;matches&quot;, &quot;num_range&quot;) 一致 &lt;- c(&quot;変数名の始まりが一致&quot;, &quot;変数名の終わりが一致&quot;, &quot;変数名の文字が一致&quot;, &quot;正規表現で一致&quot;, &quot;q01,q02,...のように一致&quot;) tibble(関数,一致) %&gt;% knitr::kable() 関数 一致 starts_with 変数名の始まりが一致 ends_with 変数名の終わりが一致 contains 変数名の文字が一致 matches 正規表現で一致 num_range q01,q02,…のように一致 d %&gt;% select(matches(&quot;[ia]&quot;)) ## # A tibble: 1,854 × 4 ## id c2a c17_1hensa c15a ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 2 68 1 ## 2 2 1 43 2 ## 3 3 2 56 3 ## 4 4 3 39 4 ## 5 5 1 59 1 ## 6 6 1 58 2 ## 7 7 2 41 4 ## 8 8 2 46 3 ## 9 9 1 35.5 3 ## 10 10 2 46 2 ## # … with 1,844 more rows 5.3.2 ケースを選択 5.3.3 欠損値の削除 5.3.4 変数の追加 5.3.5 データの要約 5.3.6 グループ別の処理 5.3.7 グループ化の解除 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
